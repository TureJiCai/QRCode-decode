/*!
 * qrcode-decode v0.0.1
 * (c) 2018-present cnwhy <w.why@163.com>
 * Released under the ISC License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.qrcodeDecode={})}(this,function(e){"use strict";function t(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var i=Math.abs(e-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1}}var n=function(e,n,i,r,s,o,a,h){this.image=e,this.possibleCenters=new Array,this.startX=i,this.startY=r,this.width=s,this.height=o,this.moduleSize=a,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=h,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,i=0;i<3;i++)if(Math.abs(t-e[i])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,i,r){var s=this.image,o=n.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var h=e;h>=0&&s[t+h*n.width]&&a[1]<=i;)a[1]++,h--;if(h<0||a[1]>i)return NaN;for(;h>=0&&!s[t+h*n.width]&&a[0]<=i;)a[0]++,h--;if(a[0]>i)return NaN;for(h=e+1;h<o&&s[t+h*n.width]&&a[1]<=i;)a[1]++,h++;if(h==o||a[1]>i)return NaN;for(;h<o&&!s[t+h*n.width]&&a[2]<=i;)a[2]++,h++;if(a[2]>i)return NaN;var w=a[0]+a[1]+a[2];return 5*Math.abs(w-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,h):NaN},this.handlePossibleCenter=function(e,n,i){var r=e[0]+e[1]+e[2],s=this.centerFromEnd(e,i),o=this.crossCheckVertical(n,Math.floor(s),2*e[1],r);if(!isNaN(o)){for(var a=(e[0]+e[1]+e[2])/3,h=this.possibleCenters.length,w=0;w<h;w++)if(this.possibleCenters[w].aboutEquals(a,o,s))return new t(s,o,a);var f=new t(s,o,a);this.possibleCenters.push(f),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(f)}return null},this.find=function(){for(var t=this.startX,i=this.height,o=t+s,a=r+(i>>1),h=new Array(0,0,0),w=0;w<i;w++){var f=a+(0==(1&w)?w+1>>1:-(w+1>>1));h[0]=0,h[1]=0,h[2]=0;for(var u=t;u<o&&!e[u+n.width*f];)u++;for(var l=0;u<o;){if(e[u+f*n.width])if(1==l)h[l]++;else if(2==l){var d;if(this.foundPatternCross(h)&&null!=(d=this.handlePossibleCenter(h,f,u)))return d;h[0]=h[2],h[1]=1,h[2]=0,l=1}else h[++l]++;else 1==l&&l++,h[l]++;u++}if(this.foundPatternCross(h)&&null!=(d=this.handlePossibleCenter(h,f,o)))return d}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}},i=3,r=57,s=8,o=2,a=function(e){function t(e,t){var n=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(n*n+i*i)}var n,i,r,s=t(e[0],e[1]),o=t(e[1],e[2]),a=t(e[0],e[2]);if(o>=s&&o>=a?(i=e[0],n=e[1],r=e[2]):a>=o&&a>=s?(i=e[1],n=e[0],r=e[2]):(i=e[2],n=e[0],r=e[1]),function(e,t,n){var i=t.x,r=t.y;return(n.x-i)*(e.y-r)-(n.y-r)*(e.x-i)}(n,i,r)<0){var h=n;n=r,r=h}e[0]=n,e[1]=i,e[2]=r};var h=function(e){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var i=e[n];if(0==i)return!1;t+=i}if(t<7)return!1;var r=Math.floor((t<<s)/7),o=Math.floor(r/2);return Math.abs(r-(e[0]<<s))<o&&Math.abs(r-(e[1]<<s))<o&&Math.abs(3*r-(e[2]<<s))<3*o&&Math.abs(r-(e[3]<<s))<o&&Math.abs(r-(e[4]<<s))<o},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(t,n,i,r){for(var s=this.image,o=e.height,a=this.CrossCheckStateCount,h=t;h>=0&&s[n+h*e.width];)a[2]++,h--;if(h<0)return NaN;for(;h>=0&&!s[n+h*e.width]&&a[1]<=i;)a[1]++,h--;if(h<0||a[1]>i)return NaN;for(;h>=0&&s[n+h*e.width]&&a[0]<=i;)a[0]++,h--;if(a[0]>i)return NaN;for(h=t+1;h<o&&s[n+h*e.width];)a[2]++,h++;if(h==o)return NaN;for(;h<o&&!s[n+h*e.width]&&a[3]<i;)a[3]++,h++;if(h==o||a[3]>=i)return NaN;for(;h<o&&s[n+h*e.width]&&a[4]<i;)a[4]++,h++;if(a[4]>=i)return NaN;var w=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(w-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,h):NaN},this.crossCheckHorizontal=function(t,n,i,r){for(var s=this.image,o=e.width,a=this.CrossCheckStateCount,h=t;h>=0&&s[h+n*e.width];)a[2]++,h--;if(h<0)return NaN;for(;h>=0&&!s[h+n*e.width]&&a[1]<=i;)a[1]++,h--;if(h<0||a[1]>i)return NaN;for(;h>=0&&s[h+n*e.width]&&a[0]<=i;)a[0]++,h--;if(a[0]>i)return NaN;for(h=t+1;h<o&&s[h+n*e.width];)a[2]++,h++;if(h==o)return NaN;for(;h<o&&!s[h+n*e.width]&&a[3]<i;)a[3]++,h++;if(h==o||a[3]>=i)return NaN;for(;h<o&&s[h+n*e.width]&&a[4]<i;)a[4]++,h++;if(a[4]>=i)return NaN;var w=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(w-r)>=r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,h):NaN},this.handlePossibleCenter=function(e,t,n){var i=e[0]+e[1]+e[2]+e[3]+e[4],r=this.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(r),e[2],i);if(!isNaN(s)&&(r=this.crossCheckHorizontal(Math.floor(r),Math.floor(s),e[2],i),!isNaN(r))){for(var o=i/7,a=!1,h=this.possibleCenters.length,w=0;w<h;w++){var f=this.possibleCenters[w];if(f.aboutEquals(o,s,r)){f.incrementCount(),a=!0;break}}if(!a){var u=new function(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var i=Math.abs(e-this.estimatedModuleSize);return i<=1||i/this.estimatedModuleSize<=1}return!1}}(r,s,o);this.possibleCenters.push(u),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(u)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw"Couldn't find enough finder patterns (found "+e+")";if(e>3){for(var t=0,n=0,i=0;i<e;i++){var r=this.possibleCenters[i].EstimatedModuleSize;t+=r,n+=r*r}var s=t/e;this.possibleCenters.sort(function(e,t){var n=Math.abs(t.EstimatedModuleSize-s),i=Math.abs(e.EstimatedModuleSize-s);return n<i?-1:n==i?0:1});var o=Math.sqrt(n/e-s*s),a=Math.max(.2*s,o);for(i=this.possibleCenters.length-1;i>=0;i--){var h=this.possibleCenters[i];Math.abs(h.EstimatedModuleSize-s)>a&&this.possibleCenters.splice(i,1)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var i=this.possibleCenters[n];if(i.Count>=o){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-i.X)-Math.abs(t.Y-i.Y))/2);t=i}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,i=0;i<n;i++){var r=this.possibleCenters[i];r.Count>=o&&(e++,t+=r.EstimatedModuleSize)}if(e<3)return!1;var s=t/n,a=0;for(i=0;i<n;i++)r=this.possibleCenters[i],a+=Math.abs(r.EstimatedModuleSize-s);return a<=.05*t},this.findFinderPattern=function(t){this.image=t;var n=e.height,s=e.width,o=Math.floor(3*n/(4*r));o<i&&(o=i);for(var h=!1,w=new Array(5),f=o-1;f<n&&!h;f+=o){w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0;for(var u=0,l=0;l<s;l++)if(t[l+f*e.width])1==(1&u)&&u++,w[u]++;else if(0==(1&u))if(4==u)if(this.foundPatternCross(w)){if(this.handlePossibleCenter(w,f,l))if(o=2,this.hasSkipped)h=this.haveMultiplyConfirmedCenters();else{var d=this.findRowSkip();d>w[2]&&(f+=d-w[2]-o,l=s-1)}else{do{l++}while(l<s&&!t[l+f*e.width]);l--}u=0,w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0}else w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,u=3;else w[++u]++;else w[u]++;this.foundPatternCross(w)&&this.handlePossibleCenter(w,f,s)&&(o=w[0],this.hasSkipped&&(h=this.haveMultiplyConfirmedCenters()))}var c=this.selectBestPatterns();return a(c),new function(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}(c)}},w=function(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)};function f(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}var u=new f(0,1,"L"),l=new f(1,0,"M"),d=new f(2,3,"Q"),c=new f(3,2,"H"),v=new Array(l,u,c,d),g=function(e){if(e<0||e>=v.length)throw"ArgumentException";return v[e]},m=w,b=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),y=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);function C(e){this.errorCorrectionLevel=g(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}C.numBitsDiffering=function(e,t){return y[15&(e^=t)]+y[15&m(e,4)]+y[15&m(e,8)]+y[15&m(e,12)]+y[15&m(e,16)]+y[15&m(e,20)]+y[15&m(e,24)]+y[15&m(e,28)]},C.decodeFormatInformation=function(e){var t=C.doDecodeFormatInformation(e);return null!=t?t:C.doDecodeFormatInformation(21522^e)},C.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,i=0;i<b.length;i++){var r=b[i],s=r[0];if(s==e)return new C(r[1]);var o=this.numBitsDiffering(e,s);o<t&&(n=r[1],t=o)}return t<=3?new C(n):null};var _=C,A=w;var p=function(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var i=0;i<this.bits.length;i++)this.bits[i]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&A(this.bits[n],31&e))},this.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},this.setRegion=function(e,t,n,i){if(t<0||e<0)throw"Left and top must be nonnegative";if(i<1||n<1)throw"Height and width must be at least 1";var r=e+n,s=t+i;if(s>this.height||r>this.width)throw"The region must fit inside the matrix";for(var o=t;o<s;o++)for(var a=o*this.rowSize,h=e;h<r;h++)this.bits[a+(h>>5)]|=1<<(31&h)}};function M(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function k(e,t,n){this.ecCodewordsPerBlock=e,this.ecBlocks=n?new Array(t,n):new Array(t),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}),this.getECBlocks=function(){return this.ecBlocks}}function P(e,t,n,i,r,s){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,i,r,s);for(var o=0,a=n.ECCodewordsPerBlock,h=n.getECBlocks(),w=0;w<h.length;w++){var f=h[w];o+=f.Count*(f.DataCodewords+a)}this.totalCodewords=o,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new p(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,i=0;i<n;i++)for(var r=this.alignmentPatternCenters[i]-2,s=0;s<n;s++)0==i&&(0==s||s==n-1)||i==n-1&&0==s||t.setRegion(this.alignmentPatternCenters[s]-2,r,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}P.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),P.VERSIONS=new Array(new P(1,new Array,new k(7,new M(1,19)),new k(10,new M(1,16)),new k(13,new M(1,13)),new k(17,new M(1,9))),new P(2,new Array(6,18),new k(10,new M(1,34)),new k(16,new M(1,28)),new k(22,new M(1,22)),new k(28,new M(1,16))),new P(3,new Array(6,22),new k(15,new M(1,55)),new k(26,new M(1,44)),new k(18,new M(2,17)),new k(22,new M(2,13))),new P(4,new Array(6,26),new k(20,new M(1,80)),new k(18,new M(2,32)),new k(26,new M(2,24)),new k(16,new M(4,9))),new P(5,new Array(6,30),new k(26,new M(1,108)),new k(24,new M(2,43)),new k(18,new M(2,15),new M(2,16)),new k(22,new M(2,11),new M(2,12))),new P(6,new Array(6,34),new k(18,new M(2,68)),new k(16,new M(4,27)),new k(24,new M(4,19)),new k(28,new M(4,15))),new P(7,new Array(6,22,38),new k(20,new M(2,78)),new k(18,new M(4,31)),new k(18,new M(2,14),new M(4,15)),new k(26,new M(4,13),new M(1,14))),new P(8,new Array(6,24,42),new k(24,new M(2,97)),new k(22,new M(2,38),new M(2,39)),new k(22,new M(4,18),new M(2,19)),new k(26,new M(4,14),new M(2,15))),new P(9,new Array(6,26,46),new k(30,new M(2,116)),new k(22,new M(3,36),new M(2,37)),new k(20,new M(4,16),new M(4,17)),new k(24,new M(4,12),new M(4,13))),new P(10,new Array(6,28,50),new k(18,new M(2,68),new M(2,69)),new k(26,new M(4,43),new M(1,44)),new k(24,new M(6,19),new M(2,20)),new k(28,new M(6,15),new M(2,16))),new P(11,new Array(6,30,54),new k(20,new M(4,81)),new k(30,new M(1,50),new M(4,51)),new k(28,new M(4,22),new M(4,23)),new k(24,new M(3,12),new M(8,13))),new P(12,new Array(6,32,58),new k(24,new M(2,92),new M(2,93)),new k(22,new M(6,36),new M(2,37)),new k(26,new M(4,20),new M(6,21)),new k(28,new M(7,14),new M(4,15))),new P(13,new Array(6,34,62),new k(26,new M(4,107)),new k(22,new M(8,37),new M(1,38)),new k(24,new M(8,20),new M(4,21)),new k(22,new M(12,11),new M(4,12))),new P(14,new Array(6,26,46,66),new k(30,new M(3,115),new M(1,116)),new k(24,new M(4,40),new M(5,41)),new k(20,new M(11,16),new M(5,17)),new k(24,new M(11,12),new M(5,13))),new P(15,new Array(6,26,48,70),new k(22,new M(5,87),new M(1,88)),new k(24,new M(5,41),new M(5,42)),new k(30,new M(5,24),new M(7,25)),new k(24,new M(11,12),new M(7,13))),new P(16,new Array(6,26,50,74),new k(24,new M(5,98),new M(1,99)),new k(28,new M(7,45),new M(3,46)),new k(24,new M(15,19),new M(2,20)),new k(30,new M(3,15),new M(13,16))),new P(17,new Array(6,30,54,78),new k(28,new M(1,107),new M(5,108)),new k(28,new M(10,46),new M(1,47)),new k(28,new M(1,22),new M(15,23)),new k(28,new M(2,14),new M(17,15))),new P(18,new Array(6,30,56,82),new k(30,new M(5,120),new M(1,121)),new k(26,new M(9,43),new M(4,44)),new k(28,new M(17,22),new M(1,23)),new k(28,new M(2,14),new M(19,15))),new P(19,new Array(6,30,58,86),new k(28,new M(3,113),new M(4,114)),new k(26,new M(3,44),new M(11,45)),new k(26,new M(17,21),new M(4,22)),new k(26,new M(9,13),new M(16,14))),new P(20,new Array(6,34,62,90),new k(28,new M(3,107),new M(5,108)),new k(26,new M(3,41),new M(13,42)),new k(30,new M(15,24),new M(5,25)),new k(28,new M(15,15),new M(10,16))),new P(21,new Array(6,28,50,72,94),new k(28,new M(4,116),new M(4,117)),new k(26,new M(17,42)),new k(28,new M(17,22),new M(6,23)),new k(30,new M(19,16),new M(6,17))),new P(22,new Array(6,26,50,74,98),new k(28,new M(2,111),new M(7,112)),new k(28,new M(17,46)),new k(30,new M(7,24),new M(16,25)),new k(24,new M(34,13))),new P(23,new Array(6,30,54,74,102),new k(30,new M(4,121),new M(5,122)),new k(28,new M(4,47),new M(14,48)),new k(30,new M(11,24),new M(14,25)),new k(30,new M(16,15),new M(14,16))),new P(24,new Array(6,28,54,80,106),new k(30,new M(6,117),new M(4,118)),new k(28,new M(6,45),new M(14,46)),new k(30,new M(11,24),new M(16,25)),new k(30,new M(30,16),new M(2,17))),new P(25,new Array(6,32,58,84,110),new k(26,new M(8,106),new M(4,107)),new k(28,new M(8,47),new M(13,48)),new k(30,new M(7,24),new M(22,25)),new k(30,new M(22,15),new M(13,16))),new P(26,new Array(6,30,58,86,114),new k(28,new M(10,114),new M(2,115)),new k(28,new M(19,46),new M(4,47)),new k(28,new M(28,22),new M(6,23)),new k(30,new M(33,16),new M(4,17))),new P(27,new Array(6,34,62,90,118),new k(30,new M(8,122),new M(4,123)),new k(28,new M(22,45),new M(3,46)),new k(30,new M(8,23),new M(26,24)),new k(30,new M(12,15),new M(28,16))),new P(28,new Array(6,26,50,74,98,122),new k(30,new M(3,117),new M(10,118)),new k(28,new M(3,45),new M(23,46)),new k(30,new M(4,24),new M(31,25)),new k(30,new M(11,15),new M(31,16))),new P(29,new Array(6,30,54,78,102,126),new k(30,new M(7,116),new M(7,117)),new k(28,new M(21,45),new M(7,46)),new k(30,new M(1,23),new M(37,24)),new k(30,new M(19,15),new M(26,16))),new P(30,new Array(6,26,52,78,104,130),new k(30,new M(5,115),new M(10,116)),new k(28,new M(19,47),new M(10,48)),new k(30,new M(15,24),new M(25,25)),new k(30,new M(23,15),new M(25,16))),new P(31,new Array(6,30,56,82,108,134),new k(30,new M(13,115),new M(3,116)),new k(28,new M(2,46),new M(29,47)),new k(30,new M(42,24),new M(1,25)),new k(30,new M(23,15),new M(28,16))),new P(32,new Array(6,34,60,86,112,138),new k(30,new M(17,115)),new k(28,new M(10,46),new M(23,47)),new k(30,new M(10,24),new M(35,25)),new k(30,new M(19,15),new M(35,16))),new P(33,new Array(6,30,58,86,114,142),new k(30,new M(17,115),new M(1,116)),new k(28,new M(14,46),new M(21,47)),new k(30,new M(29,24),new M(19,25)),new k(30,new M(11,15),new M(46,16))),new P(34,new Array(6,34,62,90,118,146),new k(30,new M(13,115),new M(6,116)),new k(28,new M(14,46),new M(23,47)),new k(30,new M(44,24),new M(7,25)),new k(30,new M(59,16),new M(1,17))),new P(35,new Array(6,30,54,78,102,126,150),new k(30,new M(12,121),new M(7,122)),new k(28,new M(12,47),new M(26,48)),new k(30,new M(39,24),new M(14,25)),new k(30,new M(22,15),new M(41,16))),new P(36,new Array(6,24,50,76,102,128,154),new k(30,new M(6,121),new M(14,122)),new k(28,new M(6,47),new M(34,48)),new k(30,new M(46,24),new M(10,25)),new k(30,new M(2,15),new M(64,16))),new P(37,new Array(6,28,54,80,106,132,158),new k(30,new M(17,122),new M(4,123)),new k(28,new M(29,46),new M(14,47)),new k(30,new M(49,24),new M(10,25)),new k(30,new M(24,15),new M(46,16))),new P(38,new Array(6,32,58,84,110,136,162),new k(30,new M(4,122),new M(18,123)),new k(28,new M(13,46),new M(32,47)),new k(30,new M(48,24),new M(14,25)),new k(30,new M(42,15),new M(32,16))),new P(39,new Array(6,26,54,82,110,138,166),new k(30,new M(20,117),new M(4,118)),new k(28,new M(40,47),new M(7,48)),new k(30,new M(43,24),new M(22,25)),new k(30,new M(10,15),new M(67,16))),new P(40,new Array(6,30,58,86,114,142,170),new k(30,new M(19,118),new M(6,119)),new k(28,new M(18,47),new M(31,48)),new k(30,new M(34,24),new M(34,25)),new k(30,new M(20,15),new M(61,16)))),P.getVersionForNumber=function(e){if(e<1||e>40)throw"ArgumentException";return P.VERSIONS[e-1]},P.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return P.getVersionForNumber(e-17>>2)}catch(e){throw"Error getVersionForNumber"}},P.decodeVersionInformation=function(e){for(var t=4294967295,n=0,i=0;i<P.VERSION_DECODE_INFO.length;i++){var r=P.VERSION_DECODE_INFO[i];if(r==e)return this.getVersionForNumber(i+7);var s=_.numBitsDiffering(e,r);s<t&&(n=i+7,t=s)}return t<=3?this.getVersionForNumber(n):null};var N=P,B={checkAndNudgePoints:function(e,t,n){for(var i=n.width,r=n.height,s=!0,o=0;o<t.length&&s;o+=2){var a=Math.floor(t[o]),h=Math.floor(t[o+1]);if(a<-1||a>i||h<-1||h>r)throw"Error.checkAndNudgePoints ";s=!1,-1==a?(t[o]=0,s=!0):a==i&&(t[o]=i-1,s=!0),-1==h?(t[o+1]=0,s=!0):h==r&&(t[o+1]=r-1,s=!0)}s=!0;for(o=t.length-2;o>=0&&s;o-=2){a=Math.floor(t[o]),h=Math.floor(t[o+1]);if(a<-1||a>i||h<-1||h>r)throw"Error.checkAndNudgePoints ";s=!1,-1==a?(t[o]=0,s=!0):a==i&&(t[o]=i-1,s=!0),-1==h?(t[o+1]=0,s=!0):h==r&&(t[o+1]=r-1,s=!0)}},sampleGrid3:function(e,t,n,i){for(var r=new p(n),s=new Array(n<<1),o=0;o<n;o++){for(var a=s.length,h=o+.5,w=0;w<a;w+=2)s[w]=.5+(w>>1),s[w+1]=h;i.transformPoints1(s),B.checkAndNudgePoints(e,s,t);try{for(w=0;w<a;w+=2){e[Math.floor(s[w])+t.width*Math.floor(s[w+1])]&&r.set_Renamed(w>>1,o)}}catch(e){throw"Error.checkAndNudgePoints"}}return r}},E=B;function S(e,t,n,i,r,s,o,a,h){this.a11=e,this.a12=i,this.a13=o,this.a21=t,this.a22=r,this.a23=a,this.a31=n,this.a32=s,this.a33=h,this.transformPoints1=function(e){for(var t=e.length,n=this.a11,i=this.a12,r=this.a13,s=this.a21,o=this.a22,a=this.a23,h=this.a31,w=this.a32,f=this.a33,u=0;u<t;u+=2){var l=e[u],d=e[u+1],c=r*l+a*d+f;e[u]=(n*l+s*d+h)/c,e[u+1]=(i*l+o*d+w)/c}},this.transformPoints2=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i],s=t[i],o=this.a13*r+this.a23*s+this.a33;e[i]=(this.a11*r+this.a21*s+this.a31)/o,t[i]=(this.a12*r+this.a22*s+this.a32)/o}},this.buildAdjoint=function(){return new S(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new S(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}S.quadrilateralToQuadrilateral=function(e,t,n,i,r,s,o,a,h,w,f,u,l,d,c,v){var g=this.quadrilateralToSquare(e,t,n,i,r,s,o,a);return this.squareToQuadrilateral(h,w,f,u,l,d,c,v).times(g)},S.squareToQuadrilateral=function(e,t,n,i,r,s,o,a){var h=a-s,w=t-i+s-a;if(0==h&&0==w)return new S(n-e,r-n,e,i-t,s-i,t,0,0,1);var f=n-r,u=o-r,l=e-n+r-o,d=i-s,c=f*h-u*d,v=(l*h-u*w)/c,g=(f*w-l*d)/c;return new S(n-e+v*n,o-e+g*o,e,i-t+v*i,a-t+g*a,t,v,g,1)},S.quadrilateralToSquare=function(e,t,n,i,r,s,o,a){return this.squareToQuadrilateral(e,t,n,i,r,s,o,a).buildAdjoint()};var D=S;var x=function(e,t){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,n,i,r){var s=Math.abs(r-n)>Math.abs(i-e);if(s){var o=e;e=n,n=o,o=i,i=r,r=o}for(var a=Math.abs(i-e),h=Math.abs(r-n),w=-a>>1,f=n<r?1:-1,u=e<i?1:-1,l=0,d=e,c=n;d!=i;d+=u){var v=s?c:d,g=s?d:c;if(1==l?this.image[v+g*t.width]&&l++:this.image[v+g*t.width]||l++,3==l){var m=d-e,b=c-n;return Math.sqrt(m*m+b*b)}if((w+=h)>0){if(c==r)break;c+=f,w-=a}}var y=i-e,C=r-n;return Math.sqrt(y*y+C*C)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,n,i,r){var s=this.sizeOfBlackWhiteBlackRun(e,n,i,r),o=1,a=e-(i-e);a<0?(o=e/(e-a),a=0):a>=t.width&&(o=(t.width-1-e)/(a-e),a=t.width-1);var h=Math.floor(n-(r-n)*o);return o=1,h<0?(o=n/(n-h),h=0):h>=t.height&&(o=(t.height-1-n)/(h-n),h=t.height-1),a=Math.floor(e+(a-e)*o),(s+=this.sizeOfBlackWhiteBlackRun(e,n,a,h))-1},this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?i/7:isNaN(i)?n/7:(n+i)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){var n=e.X-t.X,i=e.Y-t.Y;return Math.sqrt(n*n+i*i)},this.computeDimension=function(e,t,n,i){var r=7+(Math.round(this.distance(e,t)/i)+Math.round(this.distance(e,n)/i)>>1);switch(3&r){case 0:r++;break;case 2:r--;break;case 3:throw"Error"}return r},this.findAlignmentInRegion=function(e,i,r,s){var o=Math.floor(s*e),a=Math.max(0,i-o),h=Math.min(t.width-1,i+o);if(h-a<3*e)throw"Error";var w=Math.max(0,r-o),f=Math.min(t.height-1,r+o);return new n(this.image,t,a,w,h-a,f-w,e,this.resultPointCallback).find()},this.createTransform=function(e,t,n,i,r){var s,o,a,h,w=r-3.5;return null!=i?(s=i.X,o=i.Y,a=h=w-3):(s=t.X-e.X+n.X,o=t.Y-e.Y+n.Y,a=h=w),D.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,a,h,3.5,w,e.X,e.Y,t.X,t.Y,s,o,n.X,n.Y)},this.sampleGrid=function(e,n,i){return E.sampleGrid3(e,t,i,n)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,i=e.BottomLeft,r=this.calculateModuleSize(t,n,i);if(r<1)throw"Error";var s=this.computeDimension(t,n,i,r),o=N.getProvisionalVersionForDimension(s),a=o.DimensionForVersion-7,h=null;if(o.AlignmentPatternCenters.length>0)for(var w=n.X-t.X+i.X,f=n.Y-t.Y+i.Y,u=1-3/a,l=Math.floor(t.X+u*(w-t.X)),d=Math.floor(t.Y+u*(f-t.Y)),c=4;c<=16;c<<=1){h=this.findAlignmentInRegion(r,l,d,c);break}var v=this.createTransform(t,n,i,h,s);return new function(e,t){this.bits=e,this.points=t}(this.sampleGrid(this.image,v,s),null==h?new Array(i,t,n):new Array(i,t,n,h))},this.detect=function(){var e=new h(t).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}},F=function(e,t){return e^t};var R=function e(t,n){if(null==n||0==n.length)throw"System.ArgumentException";this.field=t;var i=n.length;if(i>1&&0==n[0]){for(var r=1;r<i&&0==n[r];)r++;if(r==i)this.coefficients=t.Zero.coefficients;else{this.coefficients=new Array(i-r);for(var s=0;s<this.coefficients.length;s++)this.coefficients[s]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=n[r+o]}}else this.coefficients=n;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,i=0;i<t;i++)n=F(n,this.coefficients[i]);return n}var r=this.coefficients[0];for(i=1;i<t;i++)r=F(this.field.multiply(e,r),this.coefficients[i]);return r},this.addOrSubtract=function(n){if(this.field!=n.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return n;if(n.Zero)return this;var i=this.coefficients,r=n.coefficients;if(i.length>r.length){var s=i;i=r,r=s}for(var o=new Array(r.length),a=r.length-i.length,h=0;h<a;h++)o[h]=r[h];for(var w=a;w<r.length;w++)o[w]=F(i[w-a],r[w]);return new e(t,o)},this.multiply1=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||t.Zero)return this.field.Zero;for(var n=this.coefficients,i=n.length,r=t.coefficients,s=r.length,o=new Array(i+s-1),a=0;a<i;a++)for(var h=n[a],w=0;w<s;w++)o[a+w]=F(o[a+w],this.field.multiply(h,r[w]));return new e(this.field,o)},this.multiply2=function(t){if(0==t)return this.field.Zero;if(1==t)return this;for(var n=this.coefficients.length,i=new Array(n),r=0;r<n;r++)i[r]=this.field.multiply(this.coefficients[r],t);return new e(this.field,i)},this.multiplyByMonomial=function(t,n){if(t<0)throw"System.ArgumentException";if(0==n)return this.field.Zero;for(var i=this.coefficients.length,r=new Array(i+t),s=0;s<r.length;s++)r[s]=0;for(s=0;s<i;s++)r[s]=this.field.multiply(this.coefficients[s],n);return new e(this.field,r)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,i=e.getCoefficient(e.Degree),r=this.field.inverse(i);n.Degree>=e.Degree&&!n.Zero;){var s=n.Degree-e.Degree,o=this.field.multiply(n.getCoefficient(n.Degree),r),a=e.multiplyByMonomial(s,o),h=this.field.buildMonomial(s,o);t=t.addOrSubtract(h),n=n.addOrSubtract(a)}return new Array(t,n)}};function G(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;n<256;n++)this.expTable[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var i=new Array(1);i[0]=0,this.zero=new R(this,new Array(i));var r=new Array(1);r[0]=1,this.one=new R(this,new Array(r)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(0==t)return this.zero;for(var n=new Array(e+1),i=0;i<n.length;i++)n[i]=0;return n[0]=t,new R(this,n)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}G.QR_CODE_FIELD=new G(285),G.DATA_MATRIX_FIELD=new G(301),G.addOrSubtract=function(e,t){return e^t};var I=G,V=w,z={};z.forReference=function(e){if(e<0||e>7)throw"System.ArgumentException";return z.DATA_MASKS[e]},z.DATA_MASKS=new Array(new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(e+t&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return t%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return(e+t)%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==(V(e,1)+t/3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}});var O=z;function T(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}T.getDataBlocks=function(e,t,n){if(e.length!=t.TotalCodewords)throw"ArgumentException";for(var i=t.getECBlocksForLevel(n),r=0,s=i.getECBlocks(),o=0;o<s.length;o++)r+=s[o].Count;for(var a=new Array(r),h=0,w=0;w<s.length;w++){var f=s[w];for(o=0;o<f.Count;o++){var u=f.DataCodewords,l=i.ECCodewordsPerBlock+u;a[h++]=new T(u,new Array(l))}}for(var d=a[0].codewords.length,c=a.length-1;c>=0;){if(a[c].codewords.length==d)break;c--}c++;var v=d-i.ECCodewordsPerBlock,g=0;for(o=0;o<v;o++)for(w=0;w<h;w++)a[w].codewords[o]=e[g++];for(w=c;w<h;w++)a[w].codewords[v]=e[g++];var m=a[0].codewords.length;for(o=v;o<m;o++)for(w=0;w<h;w++){var b=w<c?o:o+1;a[w].codewords[b]=e[g++]}return a};var L=T,X=[[10,9,8,8],[12,11,16,10],[14,13,16,12]];var Y=function(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,i=0;i<e;i++)n+=1<<i;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){var r=0;for(i=0;i<this.bitPointer+1;i++)r+=1<<i;return t=(this.blocks[this.blockPointer]&r)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){r=0;var s=0;for(i=0;i<this.bitPointer+1;i++)r+=1<<i;var o=(this.blocks[this.blockPointer]&r)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);for(this.blockPointer++,i=0;i<e-(this.bitPointer+1+8);i++)s+=1<<i;return s<<=8-(e-(this.bitPointer+1+8)),t=o+a+((this.blocks[this.blockPointer]&s)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(X[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,i="",r=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var s=(n=this.getNextBits(11))%45;i+=r[Math.floor(n/45)],i+=r[s],t-=2}else 1==t&&(i+=r[n=this.getNextBits(6)],t-=1)}while(t>0);return i},this.getFigureString=function(e){var t=e,n=0,i="";do{t>=3?((n=this.getNextBits(10))<100&&(i+="0"),n<10&&(i+="0"),t-=3):2==t?((n=this.getNextBits(7))<10&&(i+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),i+=n}while(t>0);return i},this.get8bitByteArray=function(e){var t=e,n=0,i=new Array;do{n=this.getNextBits(8),i.push(n),t--}while(t>0);return i},this.getKanjiString=function(e){var t=e,n=0,i="";do{var r=((n=this.getNextBits(13))/192<<8)+n%192,s=0;s=r+33088<=40956?r+33088:r+49472,i+=String.fromCharCode(s),t--}while(t>0);return i},this.parseECIValue=function(){var e=0,t=this.getNextBits(8);return 0==(128&t)&&(e=127&t),128==(192&t)&&(e=(63&t)<<8|this.getNextBits(8)),192==(224&t)&&(e=(31&t)<<16|this.getNextBits(8)),e},this.__defineGetter__("DataByte",function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t&&7!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(7==t)var n=this.parseECIValue();else{var i=this.getDataLength(t);if(i<1)throw"Invalid data length: "+i;switch(t){case 1:for(var r=this.getFigureString(i),s=new Array(r.length),o=0;o<r.length;o++)s[o]=r.charCodeAt(o);e.push(s);break;case 2:for(r=this.getRomanAndFigureString(i),s=new Array(r.length),o=0;o<r.length;o++)s[o]=r.charCodeAt(o);e.push(s);break;case 4:n=this.get8bitByteArray(i),e.push(n);break;case 8:r=this.getKanjiString(i),e.push(r)}}}return e})},q={};q.rsDecoder=new function(e){this.field=e,this.decode=function(e,t){for(var n=new R(this.field,e),i=new Array(t),r=0;r<i.length;r++)i[r]=0;var s=!0;for(r=0;r<t;r++){var o=n.evaluateAt(this.field.exp(r));i[i.length-1-r]=o,0!=o&&(s=!1)}if(!s){var a=new R(this.field,i),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),w=h[0],f=h[1],u=this.findErrorLocations(w),l=this.findErrorMagnitudes(f,u,!1);for(r=0;r<u.length;r++){var d=e.length-1-this.field.log(u[r]);if(d<0)throw"ReedSolomonException Bad error location";e[d]=I.addOrSubtract(e[d],l[r])}}},this.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var i=e;e=t,t=i}for(var r=e,s=t,o=this.field.One,a=this.field.Zero,h=this.field.Zero,w=this.field.One;s.Degree>=Math.floor(n/2);){var f=r,u=o,l=h;if(o=a,h=w,(r=s).Zero)throw"r_{i-1} was zero";s=f;for(var d=this.field.Zero,c=r.getCoefficient(r.Degree),v=this.field.inverse(c);s.Degree>=r.Degree&&!s.Zero;){var g=s.Degree-r.Degree,m=this.field.multiply(s.getCoefficient(s.Degree),v);d=d.addOrSubtract(this.field.buildMonomial(g,m)),s=s.addOrSubtract(r.multiplyByMonomial(g,m))}a=d.multiply1(o).addOrSubtract(u),w=d.multiply1(h).addOrSubtract(l)}var b=w.getCoefficient(0);if(0==b)throw"ReedSolomonException sigmaTilde(0) was zero";var y=this.field.inverse(b),C=w.multiply2(y),_=s.multiply2(y);return new Array(C,_)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),i=0,r=1;r<256&&i<t;r++)0==e.evaluateAt(r)&&(n[i]=this.field.inverse(r),i++);if(i!=t)throw"Error locator degree does not match number of roots";return n},this.findErrorMagnitudes=function(e,t,n){for(var i=t.length,r=new Array(i),s=0;s<i;s++){for(var o=this.field.inverse(t[s]),a=1,h=0;h<i;h++)s!=h&&(a=this.field.multiply(a,I.addOrSubtract(1,this.field.multiply(t[h],o))));r[s]=this.field.multiply(e.evaluateAt(o),this.field.inverse(a)),n&&(r[s]=this.field.multiply(r[s],o))}return r}}(I.QR_CODE_FIELD),q.correctErrors=function(e,t){for(var n=e.length,i=new Array(n),r=0;r<n;r++)i[r]=255&e[r];var s=e.length-t;try{q.rsDecoder.decode(i,s)}catch(e){throw e}for(r=0;r<t;r++)e[r]=i[r]},q.decode=function(e){for(var t=new function(e){var t=e.Dimension;if(t<21||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=_.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var i=this.bitMatrix.Dimension;e=0;var r=i-8;for(t=i-1;t>=r;t--)e=this.copyBit(t,8,e);for(n=i-7;n<i;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=_.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return N.getVersionForNumber(t);for(var n=0,i=e-11,r=5;r>=0;r--)for(var s=e-9;s>=i;s--)n=this.copyBit(s,r,n);if(this.parsedVersion=N.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;for(n=0,s=5;s>=0;s--)for(r=e-9;r>=i;r--)n=this.copyBit(s,r,n);if(this.parsedVersion=N.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=O.forReference(e.DataMask),i=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,i);for(var r=t.buildFunctionPattern(),s=!0,o=new Array(t.TotalCodewords),a=0,h=0,w=0,f=i-1;f>0;f-=2){6==f&&f--;for(var u=0;u<i;u++)for(var l=s?i-1-u:u,d=0;d<2;d++)r.get_Renamed(f-d,l)||(w++,h<<=1,this.bitMatrix.get_Renamed(f-d,l)&&(h|=1),8==w&&(o[a++]=h,w=0,h=0));s^=!0}if(a!=t.TotalCodewords)throw"Error readCodewords";return o}}(e),n=t.readVersion(),i=t.readFormatInformation().ErrorCorrectionLevel,r=t.readCodewords(),s=L.getDataBlocks(r,n,i),o=0,a=0;a<s.length;a++)o+=s[a].NumDataCodewords;for(var h=new Array(o),w=0,f=0;f<s.length;f++){var u=s[f],l=u.Codewords,d=u.NumDataCodewords;q.correctErrors(l,d);for(a=0;a<d;a++)h[w++]=l[a]}return new Y(h,n.VersionNumber,i.Bits)};var Z=q;var W=function(e,t){var n=function(e,t,n){for(var i=new Array(t.width*t.height),r=function(e,t){return function(n,i){if(t.width<n||t.height<i)throw"point error";var r=4*n+i*t.width*4;return(33.33*e[r]+33.33*e[r+1]+33.33*e[r+2])/100}}(e,t),s=0;s<t.height;s++)for(var o=0;o<t.width;o++){var a=r(o,s);i[o+s*t.width]=a<=n}return i}(e,t,153),i=new x(n,t).detect();if(t.debugfn){for(var r=[],s=0;s<i.bits.Height;s++)for(var o=0;o<i.bits.Width;o++)r.push(!!i.bits.get_Renamed(o,s)||0);debugfn(r,i.bits.Width)}e=Z.decode(i.bits).DataByte;for(var a="",h=0;h<e.length;h++)for(var w=0;w<e[h].length;w++)a+=String.fromCharCode(e[h][w]);return a},Q=function(e,t){var n={width:e.width,height:e.height,debugfn:t};return W(e.data,n)},H=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.drawImage(e,0,0,t.width,t.height);var i=n.getImageData(0,0,t.width,t.height);return Q(i)};Q.decodeByDom=H,Q.decodeByUrl=function(e,t){var n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){try{t(null,H(n))}catch(e){t(e)}},n.onerror=t};var j=Q;e.default=j,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=qrcode-decode.min.js.map
